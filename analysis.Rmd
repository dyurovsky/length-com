---
title: "length-com-pilot"
output: html_document
---

```{r load-libraries, library, message=F, results='hide', warning=FALSE}
library(tidyverse)
library(here)
library(knitr)
library(tidyboot)
library(lme4)
library(broom.mixed)
library(RColorBrewer)

opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE, 
               error = FALSE, cache = TRUE, tidy = FALSE)
theme_set(theme_classic(base_size = 16))
```

```{r read-csv}
raw_data <- read.csv(here("data/run_2_within_ss.csv")) %>%
  filter(test_part == "box_selection" | test_part == "comment")
```

```{r analysis}
mean_data <- raw_data %>%
  filter(test_part == "box_selection") %>%
  group_by(boxes_type, utt_type) %>%
  tidyboot_mean(column = accuracy)

mean_data %>%
  ggplot(aes(fill = utt_type, x = boxes_type, y = mean)) +
  geom_bar(position="dodge", stat="identity") +
  geom_errorbar(aes(ymin = ci_lower, ymax = ci_upper), 
                width = 0.2, position=position_dodge(.9))

```

```{r list-responses}
head(raw_data %>% filter(test_part == "comment") %>% select(responses), 30)

```